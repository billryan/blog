<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>东海一叶</title>
    <link>https://blog.yuanbin.me/</link>
    <description>Recent content on 东海一叶</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Tue, 25 Feb 2020 18:16:45 +0800</lastBuildDate>
    
        <atom:link href="https://blog.yuanbin.me/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>字节跳动校招/社招内推，长期有效</title>
      <link>https://blog.yuanbin.me/posts/2020-02/2020-02-25_18-16-44/</link>
      <pubDate>Tue, 25 Feb 2020 18:16:45 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2020-02/2020-02-25_18-16-44/</guid>
      
        <description>&lt;p&gt;很显然这是一篇广告，该文章长期有效，各种岗位都可以试试。先说大家关心的，海量HC！校招/实习/社招都要！全世界各地大城市基本都有，机会多多！&lt;a href=&#34;https://job.bytedance.com/&#34; title=&#34;字节职位 JD 链接&#34;&gt;字节职位 JD 链接&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;字节跳动校招内推码: &lt;strong&gt;QYVDPPA&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;从求职者的角度考虑，对于研发我能提供的辅助资源：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;简历反馈与指导，目前尽量保证3天内提供反馈&lt;/li&gt;
&lt;li&gt;可以先看我之前的校招准备及简历书写总结 &lt;a href=&#34;https://algorithm.yuanbin.me/zh-hans/appendix_i_interview_and_resume/&#34; title=&#34;面试准备及简历要点&#34;&gt;面试准备及简历要点&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/billryan/resume&#34; title=&#34;LaTex 简历模板&#34;&gt;LaTex 简历模板&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://algorithm.yuanbin.me/zh-hans/&#34; title=&#34;算法基础知识总结&#34;&gt;算法基础知识总结&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如需简历反馈和指导的，请发至 &lt;a href=&#34;mailto:yuanbin.me@bytedance.com&#34;&gt;yuanbin.me@bytedance.com&lt;/a&gt; 提高成功率&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>Mosh&#43;tmux = SSH 好帮手</title>
      <link>https://blog.yuanbin.me/posts/2020-02/2020-02-13_22-19-02/</link>
      <pubDate>Thu, 13 Feb 2020 22:19:02 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2020-02/2020-02-13_22-19-02/</guid>
      
        <description>&lt;p&gt;今天写的是一篇工具类文章，专治各种 SSH 水土不服。在平时的科研或者后端开发过程中，我们总免不了要使用远端服务器来完成我们的工作，这里面会经常遇到的一个问题是当网络断开或重连时，需要反复 SSH 重连，这点重复工作大部分人倒是不会在乎的，真正让人烦恼的是重连后，你之前运行的程序有可能被 kill 掉了，有兴趣的读者可以进一步了解操作系统进程及信号之间的细节，&lt;a href=&#34;https://serverfault.com/questions/463366/does-getting-disconnected-from-an-ssh-session-kill-your-programs&#34; title=&#34;StackExchang&#34;&gt;StackExchange&lt;/a&gt; 上有一篇不错的文章对这一行为进行了解释并提供了一些解决方案，但这些方案都不是本文想介绍的。&lt;/p&gt;
&lt;p&gt;本着以人为本的原则，本文介绍的是 Mosh + tmux 这一组合拳，当然根据你的个人习惯，tmux 换为 screen 也未尝不可。下面快速介绍为什么同时需要这两个东西一起配合。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Mosh: 可以网络漫游，切换网络等会自动重连，就像是你的 SSH 连接从未抛弃过你&lt;/li&gt;
&lt;li&gt;tmux: 可以自由定制你的命令行工作台，你的进程在 tmux 中运行，即使网络断掉，SSH 重连后 attach 之前的工作区，又可以无缝切到之前的工作状态，之前是啥样现在还是啥样，进程也不会被杀掉&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;当然这两个东西能提供的远不止以上两大好处，尤其是 tmux, 你可以加入一些自己喜欢的配置文件玩出花来。如果这两个东西只能要一样，那我会选择保留 tmux.&lt;/p&gt;
&lt;h3 id=&#34;-sshconfig&#34;&gt;善用 ~/.ssh/config&lt;/h3&gt;
&lt;p&gt;除了 SSH 连接优化类工具外，我常用的还有充分利用 &lt;code&gt;~/.ssh/config&lt;/code&gt;, 比如对一些常用的服务器，可以将主机名、用户、端口等写在配置文件中，使用时输入 &lt;code&gt;ssh dev&lt;/code&gt; 或者 &lt;code&gt;mosh dev&lt;/code&gt; 就行了，更不用说结合其它如 &lt;code&gt;rsync&lt;/code&gt; 可以大幅减少 SSH 相关指令。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Host dev
    HostName master.local.dev
    User master
    Port 5678
&lt;/code&gt;&lt;/pre&gt;</description>
      
    </item>
    
    <item>
      <title>Golang set 实现</title>
      <link>https://blog.yuanbin.me/posts/2020-02/2020-02-02_08-43-55/</link>
      <pubDate>Sun, 02 Feb 2020 08:43:56 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2020-02/2020-02-02_08-43-55/</guid>
      
        <description>&lt;p&gt;熟悉 Java 的看到这种标题，下意识会觉得这篇文章可能是分析 Go 中 set 的实现细节，但我要告诉你的是，Go 官方并没有 set 这种东西，需要的话自己去实现吧&amp;hellip; 于是有了这篇文章。知其然且知其所以然，Go 官方之所以还不提供原生的 set, 究其原因，个人猜测与 Go1 无泛型有关，map 和 slice 是 Go 在编译器层面做了手脚以支持『泛型』。可以阅读 &lt;a href=&#34;https://blog.golang.org/why-generics&#34; title=&#34;Go blog&#34;&gt;Go blog&lt;/a&gt; 的如下声明：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If we can write generic types, we can define new data structures, like these, that have the same type-checking advantages as slices and maps: the compiler can statically type-check the types of the values that they hold, and the values can be stored as themselves, not as interface types.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;有了其他语言实现 set 的先例，我们依葫芦画瓢也是可以造出来的，以 Java 为例，我们可以基于 Go 的 map 来实现 set, 由于仅需要 key, 所以 value 部分我们能省则省。最开始我想到的是使用 bool, 毕竟空间够小嘛，但是，经过一番搜索后，我们可以发现有一种叫『&lt;a href=&#34;https://dave.cheney.net/2014/03/25/the-empty-struct&#34; title=&#34;Empty struct&#34;&gt;empty struct&lt;/a&gt;』的东西，它占用的空间是 0!&lt;/p&gt;
&lt;p&gt;如果只是使用 set, 目前的 &lt;a href=&#34;https://github.com/deckarep/golang-set&#34; title=&#34;Go set&#34;&gt;golang-set&lt;/a&gt; 流传较广，可以试试，虽然线程安全的 set 实现是直接使用读写锁这种粗粒度的锁。&lt;/p&gt;
&lt;h2 id=&#34;go-collections&#34;&gt;Go collections&lt;/h2&gt;
&lt;p&gt;Go set 的轮子其实已经不少了，八仙过海各显神通，为什么我还要重新发明轮子呢？一是为 Go 生态添砖加瓦；二是想在 set 中夹带私货，一些自己需要的 feature 可以自己按需实现；三是 set 实现也确实不难，练练手也是极好的。&lt;/p&gt;
&lt;p&gt;综上，我就 fork 了一个 &lt;a href=&#34;https://github.com/billryan/collections&#34; title=&#34;Go collections&#34;&gt;go-collections&lt;/a&gt;, 逐步完善 set, queue 等一系列基础数据结构。目前 set 的实现，加了 &lt;code&gt;Foreach&lt;/code&gt;, &lt;code&gt;Map&lt;/code&gt; 和 &lt;code&gt;UnmarshalText&lt;/code&gt;(toml 解析用) 这些有意思的实现，其他移植了部分 Java 和 Python 中常用的一些方法。&lt;/p&gt;
&lt;h3 id=&#34;-set---concurrentset&#34;&gt;并发 Set - ConcurrentSet&lt;/h3&gt;
&lt;p&gt;为了尽可能减少锁的使用，并发 Set 的实现内部的 Map 借助了官方的 &lt;code&gt;sync.Map&lt;/code&gt;, 这个 Map 采用空间换时间的思路优化读多写少的场景，但遗憾的是考虑到 Map size 并不是典型应用场景及性能的 tradeoff, 官方并未加入 Len 方法，综合考虑，我决定使用 atomic 来记录增删过程中的 Map 长度。这也是 ConcurrentSet 的实现背景。&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;Reference&lt;/h2&gt;
</description>
      
    </item>
    
    <item>
      <title>关于 东海一叶</title>
      <link>https://blog.yuanbin.me/about/</link>
      <pubDate>Sun, 02 Feb 2020 00:00:00 +0000</pubDate>
      
      <guid>https://blog.yuanbin.me/about/</guid>
      
        <description>&lt;p&gt;网络上我的常用 id 为 billryan, 这是我的博客，基于 Hugo 和 jane 主题，一段时间内都不再想浪费时间折腾主题，博客引擎等与知识加工无关的因素。新的 blog 将专注于知识沉淀，以技术为主，偶尔也会有一些非技术的杂谈。&lt;/p&gt;
&lt;p&gt;本科就读于西安电子科技大学通信工程专业，2013 年考研进入上海交通大学电子工程系(EE)无线所，研究生期间主要从事无线通信网络方面的研究，2016 年 3 月硕士毕业，毕业后果断弃坑通信转向计算机软件工程师。目前在一家大型创业公司工作，个人兴趣目前主要集中在垂直领域的搜索方向，会涉及一些实时数据流 CDC 的处理，曾经从 0 到 1 负责过某互联网金融 APP 推荐系统建设。&lt;/p&gt;
&lt;p&gt;你可以通过以下方式联系/了解我&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt; &lt;strong&gt;me(at)yuanbin.me&lt;/strong&gt; OR &lt;strong&gt;yuanbin2014(at)gmail.com&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt; &lt;a href=&#34;https://github.com/billryan&#34;&gt;GitHub&lt;/a&gt; - 码代码的地方&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt; 博客主页 &lt;a href=&#34;https://blog.yuanbin.me&#34;&gt;https://blog.yuanbin.me&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt; 摄影 &lt;a href=&#34;https://instagram.com/bin.yuan/&#34;&gt;Instagram&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.yuque.com/billryan&#34;&gt;羽雀&lt;/a&gt; - 知识管理及沉淀平台&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://music.douban.com/people/billryan/&#34;&gt;豆瓣&lt;/a&gt; - 书影音&lt;/li&gt;
&lt;/ul&gt;
</description>
      
    </item>
    
    <item>
      <title>2019 年度总结</title>
      <link>https://blog.yuanbin.me/posts/2020-01/2020-01-29_23-25-37/</link>
      <pubDate>Wed, 29 Jan 2020 23:25:38 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2020-01/2020-01-29_23-25-37/</guid>
      
        <description>&lt;p&gt;2019 年，是我研究生毕业后工作的第三年，时光飞逝，自己再也不是象牙塔里的小孩子了，需要承担越来越多的责任和各方面的挑战。年度总结虽不那么『敏捷』，但把时间尺度拉长到整个生命的几十年甚至上百年时光中，定期的总结能以史为鉴，指引自己的方向，看到自己一步一步的成长轨迹。&lt;/p&gt;
&lt;h2 id=&#34;heading&#34;&gt;工作感悟&lt;/h2&gt;
&lt;p&gt;从这一年的工作经历来看，简历上确实有些难看，好在年底进入了一家个人觉得还不错的公司，公司文化和提供的福利能让员工更为高效和专注。综合这一年三家公司『丰富』的工作经验，深刻觉得好公司、好团队和好业务确实难以兼得，如果按工作体验排个序，我会倾向于一个好的团队，一个团队的天花板往往取决于团队的核心人物，团队的核心人物靠谱，能负责的业务往往不会差，机会也多。&lt;/p&gt;
&lt;p&gt;从工作内容的延续性来看，最近两三年可以认为一直在从事数据密集型应用、推荐系统和垂直领域搜索这几个领域。毕业初期做过一些大数据基础设施相关的工作，而后逐步转向应用方向，如一些客户画像、分类、AntiSpam、推荐系统和垂直领域搜索等，接触面虽广但深度还有待提升。2019 年在技术分享和总结上做的较差，2020 年争取在 CDC 实时流处理、推荐系统和 ES 搜索领域分享一些心得。&lt;/p&gt;
&lt;h2 id=&#34;heading-1&#34;&gt;旅行&lt;/h2&gt;
&lt;p&gt;2019 年 5 月去了一次大西北，走了一次青甘大环线，感慨祖国的大西北真是幅员辽阔和很多奇观异景，同时更感慨水资源的珍贵，前期的总结可以移步分类 &lt;a href=&#34;https://blog.yuanbin.me/categories/%E6%97%85%E6%B8%B8/&#34;&gt;旅游&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;heading-2&#34;&gt;书影音&lt;/h2&gt;
&lt;p&gt;2019 年的阅读量还是太少了，无论是代码、技术类书籍还是非技术类书籍，输入量都太小了。自己读过听过看过的一些比较有意思的资料总结如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://movie.douban.com/subject/34807113/&#34;&gt;走进比尔：解码比尔·盖茨&lt;/a&gt; - 看看盖茨是如何阅读和学习的，使用工程思维解决人类社会难题。他的好奇心、求知欲、工程能力和阅读习惯深深感染了我。&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://time.geekbang.org/column/intro/139&#34;&gt;MySQL实战45讲-丁奇&lt;/a&gt; - 作为后端，免不了要与数据库打交道，丁奇的这个专栏质量非常高，而且回复也极其认真，可以大大扩展自己对 MySQL 的了解和使用深度。&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://time.geekbang.org/column/intro/42&#34;&gt;技术与商业案例解读-徐飞&lt;/a&gt; - 除了纯技术外，我们也需要了解 IT 江湖的经典商业历史，以史为鉴，博采众长。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;heading-3&#34;&gt;投资&lt;/h2&gt;
&lt;p&gt;对于普通人来说，股票/基金/债券等是相对较为现实的一种投资方式，虽然这个市场可能只有 20% 不到的人是盈利的，但你可以利用钱来买到比你更适合的人去从事你所看好的行业，为你赚取更多回报。更重要的是，投资赚钱的能力是可以随着你的知识提升而提升的，那么越往后你盈利的概率就会越大。2019 年之前乱七八糟的都投过一些，曾经血赚过，也曾血亏过，也算是穿越感受过完整的牛熊周期了，越发觉得稳健的重要性。有幸遇到了小白菜推荐的『复利先生』，2019 年我尝试了可转债，虽然每次赚取利润不多，但好在心里安稳。买入的格力和场内中概互联也获利良多，视觉中国在两次黑天鹅事件后果断出手，也盈利了不少——机会是跌出来的，好公司的生意和盈利模式没有大幅改变时，一些小的黑天鹅不算啥。&lt;/p&gt;
&lt;p&gt;2020 年争取进军港美股，去香港把香港账户开了，了解更多好的科技公司，毕竟这是自己的行业，有一定的判断能力。&lt;/p&gt;
&lt;h2 id=&#34;heading-4&#34;&gt;展望&lt;/h2&gt;
&lt;p&gt;公司有使命愿景价值观，那对于我个人来说，我的使命愿景价值观又是什么呢？——那就是在有限的生命里，体验这个世界更多的可能性，尽可能给这个世界创造更多美好的东西。&lt;/p&gt;
&lt;h3 id=&#34;todo&#34;&gt;TODO&lt;/h3&gt;
&lt;ol start=&#34;0&#34;&gt;
&lt;li&gt;组建自己的小家庭，是时候送出一辈子的承诺了&lt;/li&gt;
&lt;li&gt;《原则》——阅读的过程中发现公司文化有不少和 Ray 的理念是相符的&lt;/li&gt;
&lt;li&gt;填坑 &lt;a href=&#34;https://octopusflow.github.io/&#34;&gt;octopusflow&lt;/a&gt;, 做 DAG 版的 CDC，面向搜索、推荐、缓存等 ToC 场景&lt;/li&gt;
&lt;li&gt;阅读计算机领域的一些经典论文&lt;/li&gt;
&lt;li&gt;读读 ES, lucene 的源码，深入了解检索领域的工程实现&lt;/li&gt;
&lt;li&gt;再去一次沙巴体验海岛和滑翔伞&lt;/li&gt;
&lt;li&gt;锻炼身体，早睡早起&lt;/li&gt;
&lt;/ol&gt;
</description>
      
    </item>
    
    <item>
      <title>青甘大环线-D6 张掖丹霞-227国道</title>
      <link>https://blog.yuanbin.me/posts/2019-06/2019-06-23_22-50-22/</link>
      <pubDate>Sun, 23 Jun 2019 22:50:22 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-06/2019-06-23_22-50-22/</guid>
      
        <description>&lt;blockquote&gt;
&lt;p&gt;沙尘一瞥七彩丹霞，风雪远眺皑皑雪山&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;第五天从敦煌赶往张掖，因为逛过阳关，不少人都已经对西北景点审美疲劳了，加之沙尘天气还未散去，中途的嘉峪关就直接略过了，导致一天全程基本都在路上，大环线的 D5 篇自然也就没有了。抵达张掖后，我们在丹霞景区附近住下，这一片还比较新，能吃饭的地方不多。&lt;/p&gt;
&lt;h2 id=&#34;heading&#34;&gt;张掖丹霞&lt;/h2&gt;
&lt;p&gt;由于沙尘暴的影响，我们错过了最适合观赏丹霞的晚霞时刻，下午便窝在宾馆里休息了。丹霞景区还是比较大的，游客可以凭身份证连续使用两天，在出口处登记即可。所以最佳使用方式是下午第一次使用看晚霞，第二天早上看朝霞，这两个时间点是最适合观景和拍照的。&lt;/p&gt;
&lt;p&gt;第二天早上沙尘天气依旧，但已经没有时间让我们多等一天了，我们驱车直奔丹霞景区。景区入口比一般的都要大一些，进去后又是熟悉的配方，坐大巴前往景区。景区大大小小有六个左右的片区可供观赏，其中的精华应该是最后一个和中间一个。除了大巴的方式，壕也可以选择直升机的方案鸟瞰整个景区，看普通游客看不到的景。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-16_10-18-24.jpg&#34; alt=&#34;七彩丹霞&#34;&gt;&lt;/p&gt;
&lt;p&gt;不知道是恶劣的天气原因还是网上图片P的太过，我们看到的丹霞离五彩还是有点差距的 😔 不少片区的木梯还在刷油漆，味道刺鼻，好些游客因为这个原因放弃了部分景点。附上最后一站的沙尘+七彩丹霞，天气不好真是浪费了门票。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-16_10-11-07.jpg&#34; alt=&#34;七彩丹霞气球&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;225&#34;&gt;最美225国道&lt;/h2&gt;
&lt;p&gt;225 国道被评为中国最美的几大公路之一，沿途有雪山，戈壁滩，树林等，我们从丹霞游完后便沿225国道直奔西宁而去了。张掖部分的225国道在翻修，一半的树木被割掉，这意味着以后最美国道的可观赏区域越来越短了。从气候上来说，张掖应该是大环线上城市中最像南方城市的了，温度高，水源多。&lt;/p&gt;
&lt;p&gt;祁连山下好草原，如果七月八月来草长绿了，油菜花也黄了，远处的雪山仍旧是那么白，那么这一段就能算是最美公路了。在草原之前其实还有岗什卡雪峰，因为队友不再愿意下车远眺，于是又放弃了一个景点&amp;hellip; 😔&lt;/p&gt;
&lt;p&gt;穿过岗什卡雪峰和祁连山大草原后，我们就到达了本次大环线的最后一个险峰达坂山隧道了，马路九曲回肠，我们的司机仍然开到了 90 码，不得不佩服他高超的技术。穿越达坂山隧道后就进入青海省的范围了，下山的途中水源依旧丰富，我估计秋天的时候沿途的树林金黄一片应该也美极了。&lt;/p&gt;
&lt;h2 id=&#34;heading-1&#34;&gt;全剧终&lt;/h2&gt;
&lt;p&gt;至此，本次青甘大环线的全部行程就基本告一段落了，游记也全部整理完了，遗憾不少，主要是后面三天的沙尘暴来的实在不是时候，加之队友后面 3 天对西北景点已经有审美疲劳，我们也放弃了不少景点。如果再有一次机会，我一定会选择 7 月 8 月天气好的时候，走走小环线就好了，景点密度高，和一群志同道合的年轻小伙伴一起来看看祖国的大西北。&lt;/p&gt;
&lt;p&gt;羽雀专栏——&lt;a href=&#34;https://www.yuque.com/billryan/siab93&#34;&gt;青甘大环线-西北 6 日行 · 语雀&lt;/a&gt;&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>青甘大环线-D4 敦煌莫高窟-月牙泉</title>
      <link>https://blog.yuanbin.me/posts/2019-06/2019-06-23_22-48-31/</link>
      <pubDate>Sun, 23 Jun 2019 22:48:31 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-06/2019-06-23_22-48-31/</guid>
      
        <description>&lt;blockquote&gt;
&lt;p&gt;一睹千年历史文化莫高窟，喜迎万丈黄沙飞天沙尘暴&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;敦煌整个城市不大，城市路灯，建筑和雕饰都受到了莫高窟很大的影响，飞天等形象随处可见。下图是我们晚上在『敦煌小镇』觅食的地方，里面算是传统的夜市了，很多烧烤等小吃。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-14_15-44-31.jpg&#34; alt=&#34;敦煌小镇&#34;&gt;&lt;/p&gt;
&lt;p&gt;今天的原定行程是上午逛莫高窟，下午逛鸣沙山月牙泉，但逛完莫高窟后就遇到了沙尘暴，下午去了鸣沙山后又折返回宾馆休息了。不得不说这真是全程最大的遗憾了，即使有风沙，应该也可以留下一些西北的独特记忆，出一些不错的照片。&lt;/p&gt;
&lt;h2 id=&#34;heading&#34;&gt;敦煌莫高窟&lt;/h2&gt;
&lt;p&gt;敦煌莫高窟应该是很多人考虑大环线很重要的一个景点了，沉淀了近两千年的佛教文化，对佛教有研究的同学们一定不会错过。如果你要问我全程最热门的景点是哪一处，我觉得那肯定就是莫高窟了，莫高窟的门票是比较贵的，238 一人，还得到莫高窟指定的网站或者公众号上买票预约，最佳观看时间是早上 9 点那一档，如果确定去的话，需要尽可能提前购买，旺季时一票难求。&lt;/p&gt;
&lt;p&gt;莫高窟的门票中，238 块的是包含导游费用的，进去后首先是观看两场数字电影，随后由大巴进入真正的石窟景区，前面说过了，这是西北景区的通用套路，只是莫高窟距离检票口的距离更远一些&amp;hellip; 开始观看的两场数字电影是非常有利于了解石窟文化的。球状的幕布也挺新颖。进入景区后，会有专业的导游带队，并每人戴一副耳机听讲解，这次我们能看到的石窟是 8 个，其它的都是不允许观看的。里面有一个石窟是相对早期的作品，尽管过了上千年，保存依旧还是不错的。有不少石窟被清朝翻修过，很多人物表情明显就差了些意思，没有那么精致了。能到莫高窟开窟的不是达官显贵就是皇室家族了。除了莫高窟外，旁边还有一个日本人捐建的石窟博物馆，里面也有不少作品可以身临其境观看。莫高窟内很多经典都是禁止拍照的，因此这边我几乎没有拍过照片，下面拿一张随手拍的充充数大家感受下吧。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-14_13-18-49.jpg&#34; alt=&#34;敦煌莫高窟&#34;&gt;&lt;/p&gt;
&lt;p&gt;每一个窟就像是一间房子，进去后别有一番天地，一层叠一层。莫高窟历史上经历过两次比较大的劫难，一次被大火烧个精光，一次是战乱躲进去后生火氧化毁坏了不少艺术品。清末和建国以前，也有不少西方国家在莫高窟搜刮佛像和佛经，如今想要研究敦煌文化，还得去国外各种博物馆搜集资料，真是民族的耻辱！&lt;/p&gt;
&lt;p&gt;从莫高窟出来后可以看到路旁一些未完工的别墅群，司机说是因为官商勾结贪腐查案所以成了烂尾楼，可惜，可叹。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-14_15-14-10.jpg&#34; alt=&#34;废弃别墅群&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;heading-1&#34;&gt;鸣沙山月牙泉——风沙过大放弃&lt;/h2&gt;
&lt;p&gt;从以上两张图都可以看出从莫高窟内开始天空就起了沙尘暴，这些绿林还是没能阻止黄沙的肆虐。从莫高窟出来之后我们便朝鸣沙山月牙泉走去，因为风沙太大的缘故，我们实际上先回宾馆休息了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-14_15-10-49.jpg&#34; alt=&#34;鸣山村&#34;&gt;&lt;/p&gt;
&lt;p&gt;回到宾馆后我们发现房间内靠近窗户的地方也全是沙子，西北这种风沙确实不适合人类长期居住。这种天气仍执意出行的需要戴好口罩，带相机的则需要保护好镜头，防止过多灰尘进入。在下午风变小后我们仍尝试再次出发前往鸣沙山月牙泉，走了一公里后司机说上去后什么也看不见，遂作罢。现在想想如果当初坚持去看看鸣沙山，说不定就能体会到真正的沙漠风景了。所以说要去西北的，建议还是做好这种心理准备，并能和在坏天气时也能不放弃的队友一起旅行。&lt;/p&gt;
&lt;p&gt;羽雀专栏——&lt;a href=&#34;https://www.yuque.com/billryan/siab93&#34;&gt;青甘大环线-西北 6 日行 · 语雀&lt;/a&gt;&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>青甘大环线-D3 南八仙雅丹-当金山-阳关</title>
      <link>https://blog.yuanbin.me/posts/2019-06/2019-06-23_22-41-49/</link>
      <pubDate>Sun, 23 Jun 2019 22:41:50 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-06/2019-06-23_22-41-49/</guid>
      
        <description>&lt;blockquote&gt;
&lt;p&gt;深入无人区，翻越当金山，西出阳关无故人&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;第三天的行程又是远距离旅行，途中要经过不少需要严格检查的关卡，关卡的警察叔叔们八点半左右上班，所以我们必须早上七点准时出发以尽可能减少遇上关卡查人或者查物件(看人品)的几率，查物件时需要翻开所携带的所有行李，遇上前面有几辆大巴的话一天就过去一大半了。&lt;/p&gt;
&lt;h2 id=&#34;heading&#34;&gt;南八仙雅丹&lt;/h2&gt;
&lt;p&gt;前方的第一站是『南八仙雅丹』，也被称为魔鬼城，这个地方是风蚀形成的自然景观，目之所及，几乎看不到任何生物，也没有人类常住。我们早上八点半左右就到了，这个时候几乎没风，自然也听不到呼呼的『魔鬼声』，可惜的是天公不作美，蓝天也不在。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-13_08-47-06.jpg&#34; alt=&#34;雅丹地貌&#34;&gt;&lt;/p&gt;
&lt;p&gt;值得一提的是雅丹魔鬼城这边的公厕是及其简陋的，司机一直给我们说的就是辣眼睛，需要戴防毒面具，其它一个车队的游客有因为进了一次后吐到胃酸都出来的&amp;hellip;&lt;/p&gt;
&lt;h2 id=&#34;heading-1&#34;&gt;冷湖镇偶遇野骆驼&lt;/h2&gt;
&lt;p&gt;从雅丹魔鬼城出来后我们便前往下一站当金山，在拐往冷湖镇的途中遇到了一群野骆驼，在荒凉的戈壁滩上徐徐前进。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-30_20-19-09.jpg&#34; alt=&#34;马路骆驼&#34;&gt;&lt;/p&gt;
&lt;p&gt;冷湖镇是真的冷清，街上不见一个人，只有几只塑料袋在飘来飘去。司机师傅说不能在这边吃饭，吃了必拉肚子。不怕死的大可在这尝试一下。&lt;/p&gt;
&lt;h2 id=&#34;heading-2&#34;&gt;最美公路大片&lt;/h2&gt;
&lt;p&gt;从雅丹魔鬼城开车两小时后遇到的一条公路（冷湖镇范围）是整个环线中最适合飙车和拍公路大片的马路了，两边都是荒漠，路特别直，直通天际。这条公路适合拍摄集体照或者单人的飞天照，如果遇到蓝天白云那更是美的不行。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-13_11-27-06.jpg&#34; alt=&#34;笔直公路&#34;&gt;&lt;/p&gt;
&lt;p&gt;从这条笔直公路拐弯后进入的是另一个无人区，远处的戈壁颇有点外星球的感觉。山脚下的沙石都变成白色的了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-13_12-44-05.jpg&#34; alt=&#34;无人区&#34;&gt;&lt;/p&gt;
&lt;p&gt;到当金山的时候已经下午了，山上的雪仍然未化，山路十八弯估计会让不少马路杀手闻风丧胆。&lt;/p&gt;
&lt;h2 id=&#34;heading-3&#34;&gt;阿克塞小镇&lt;/h2&gt;
&lt;p&gt;过了当金山，基本就是甘肃的领地了，下山后有一个石油小镇的遗址，有不少电影道具还在那边留着，我们一行人兴趣不大就略过直接赶往阿克塞镇上直接吃中饭了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-30_20-53-23.jpg&#34; alt=&#34;阿克塞小镇&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;heading-4&#34;&gt;阳关&lt;/h2&gt;
&lt;p&gt;离开阿克塞小镇之后我们就直奔阳关了——劝君更尽一杯酒，西出阳关无故人。阳关的门票在线买的话需要提前半小时买，如果没有优惠就直接现场买，买完后蹭一个导游是最好的。到阳关的路上也是一路黄沙，有一小处有风蚀的雅丹地貌，拍照应该不错。快到阳关时我们已能远远地看到一大片绿林，在沙漠中很是茂盛，走进时发现这边是水源的聚集地，也是沙漠中的绿洲。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-30_20-53-23.jpg&#34; alt=&#34;沙漠战车&#34;&gt;&lt;/p&gt;
&lt;p&gt;除了绿洲，其它方向仍然是满目苍痍，寸草不生。此情此景不得不感概水源对生命的重要性，丝绸之路的开通真是不容易。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-13_18-03-05.jpg&#34; alt=&#34;阳关绿洲&#34;&gt;&lt;/p&gt;
&lt;p&gt;羽雀专栏——&lt;a href=&#34;https://www.yuque.com/billryan/siab93&#34;&gt;青甘大环线-西北 6 日行 · 语雀&lt;/a&gt;&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>青甘大环线-D2 德令哈-大柴旦镇翡翠湖</title>
      <link>https://blog.yuanbin.me/posts/2019-06/2019-06-23_22-36-49/</link>
      <pubDate>Sun, 23 Jun 2019 22:36:50 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-06/2019-06-23_22-36-49/</guid>
      
        <description>&lt;blockquote&gt;
&lt;p&gt;深入柴达木盆地腹地，巧遇德令哈外星人遗址，邂逅最美大柴旦镇翡翠湖&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;第二天的行程本可以安排早上的茶卡盐湖和下午的翡翠湖，但我们在第一天下午已经逛过茶卡盐湖天空一号，对景区极为失望，虽然第二天天气非常适合去盐湖拍照，但我们还是放弃了，直接前往400公里开外的大柴旦镇。
西北这边两个小镇之间往往相隔较远，几十公里上百公里也常见，所以测速基本以区间测速为主，我们在途中路况好的地方跑150码左右，然后在途中一些点下车拍照休息。我们早上八点多出发，下午近一点抵达大柴旦镇。&lt;/p&gt;
&lt;h2 id=&#34;heading&#34;&gt;德令哈外星人遗址&lt;/h2&gt;
&lt;p&gt;途经德令哈的时候司机给我们说这边有外星人基地，我首先是很不屑一顾地笑了笑，以为又是师傅说的一个当地流传的神话故事，万万没想到的是，这个遗址还真是真实存在，名字还是『外星人遗址』！前往外星人遗址的话，又得往返近150公里了，而且现在那个遗址已经坍塌，也看不到多少有价值的东西了，作罢。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-12_11-05-38.jpg&#34; alt=&#34;德令哈外星人遗址&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;heading-1&#34;&gt;大柴旦镇&lt;/h2&gt;
&lt;p&gt;前往大柴旦镇的旅途属于柴达木盆地的一部分，极具西北特色，5月份的路边满目荒凉，基本只有黄色的骆驼草，野生的黑枸杞等，唯一值得让人欣慰的就是远方的雪山了。下图雪山脚下的小镇就是大柴旦镇了，远处看着不大，但实际步行起来还是有点规模的。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-12_12-52-34.jpg&#34; alt=&#34;柴旦镇&#34;&gt;&lt;/p&gt;
&lt;p&gt;在大柴旦镇走了几条街，发现这边除了本地饭店之外基本就是川菜了，颇具规模。在这边吃完中饭后，我们便趁人少顶着烈日去了翡翠湖景区，翡翠湖景区目前还处于开发中，不收门票，和茶卡盐湖类似也是盐湖，但相比天空一号来说规模小很多。远处看似就在小镇旁边，但实际上离大柴旦镇有七八公里远，进去的一段沙石路并不好走。&lt;/p&gt;
&lt;h2 id=&#34;heading-2&#34;&gt;翡翠湖&lt;/h2&gt;
&lt;p&gt;在快抵达翡翠湖时我们发现已经有从茶卡镇那边陆续过来的大巴了，两辆大巴的人几乎就能把整个翡翠湖塞满，不敢想象七八月旺季的时候那里人山人海的场景。翡翠湖之所以叫翡翠湖，是因为其中一两个盐湖颜色绿的像翡翠。听司机说的其实在这个翡翠湖之前，还有些其它颜色如红色的盐湖，天气好遇到晚霞时景色异常艳丽。但是在工业开采过后，很多曾经美丽的五颜六色的盐湖都消失了。目前景区还在开发中，暂未收费，预计下半年修好后就会开始收费了。现在游客能观看的一般是三个湖，两个翡翠色深一点，另外一个浅一些，另外还有一个几乎没有水的盐湖。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-12_16-02-51.jpg&#34; alt=&#34;柴旦镇&#34;&gt;&lt;/p&gt;
&lt;p&gt;中午时分感觉风不大，但当我们到达湖边时风已经起来了，想要达到和茶卡盐湖类似的镜面效果也是奢求了，刚进去的两个湖颜色还挺耐看的，但后面这个湖的颜色就差强人意了，风大的时候雪山的倒影也不清晰。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-12_16-00-33.jpg&#34; alt=&#34;翡翠湖&#34;&gt;&lt;/p&gt;
&lt;p&gt;逛完了几处翡翠色的小湖，我们来到了靠近雪山脚下的一片盐田寻找灵感，人可以穿鞋踩进去也不用担心陷进去。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-12_16-10-38.jpg&#34; alt=&#34;翡翠湖&#34;&gt;&lt;/p&gt;
&lt;p&gt;晚上八点半左右日落时本还有所期待，没想到风仍然是大成狗，而且也没有一点晚霞的样子，晚上出来看星空也没有看到银河，有点小失望 😞&lt;/p&gt;
&lt;p&gt;羽雀专栏——&lt;a href=&#34;https://www.yuque.com/billryan/siab93&#34;&gt;青甘大环线-西北 6 日行 · 语雀&lt;/a&gt;&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>青甘大环线-D1 塔尔寺-拉脊山-青海湖-茶卡盐湖</title>
      <link>https://blog.yuanbin.me/posts/2019-06/2019-06-15_15-40-53/</link>
      <pubDate>Sat, 15 Jun 2019 15:40:53 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-06/2019-06-15_15-40-53/</guid>
      
        <description>&lt;blockquote&gt;
&lt;p&gt;翻越拉脊山，醉美青海湖，远眺日月山，梦断茶卡盐湖&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;heading&#34;&gt;塔尔寺&lt;/h2&gt;
&lt;p&gt;在西宁修整一晚后，我们便按照司机吩咐早上七点吃完早餐将行礼放至车上前往塔尔寺，塔尔寺是一座非常有名的西北藏传佛教寺，历史悠久，距离西宁市区不算近，约有五十公里。我们行至塔尔寺脚下时，已经过了七点半，这时已经有工作人员上班封路了。正当我们认为要去他们指定的停车场并付费乘坐电瓶车时，老司机说他有祖传的密道，直达寺庙入口。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-11_08-07-00.jpg&#34; alt=&#34;塔尔寺&#34;&gt;&lt;/p&gt;
&lt;p&gt;塔尔寺内较大，里面不仅有各种佛像金身，也有历史悠久的艺术瑰宝。我们一行人中虽有信佛的但是对这种历史悠久的藏传佛教文化所知还是甚少，蹭了几个导游了解了一些历史和文化，也不枉白来一趟。门内外的转轮和游览方向几乎都遵循顺时针方向，到处都遍布着虔诚的信徒。考虑到路途遥远，我们在寺内逛了差不多两小时后便前往下一站拉脊山了。&lt;/p&gt;
&lt;h2 id=&#34;heading-1&#34;&gt;拉脊山&lt;/h2&gt;
&lt;p&gt;从塔尔寺到拉脊山大约40公里，但由于沿途要翻山越岭走盘山公路，我们实际花了约40分钟抵达山峰。对于我们这种从南方长大的孩子，沿途能远眺到白皑皑的雪山时已激动不已，雪是那么的白，天空也非常干净，唯独图中的挡风玻璃是个 bug。沿途从山脚三千多米到山峰四千多米，我们明显能感觉到风越来越大，气温越来越低，沿途遇到不错的风景下车时需要注意防寒保暖。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-11_10-09-58.jpg&#34; alt=&#34;拉脊山路上&#34;&gt;&lt;/p&gt;
&lt;p&gt;拉脊山峰处其实不大，风倒是呼呼地刮，一件薄薄的轻羽绒根本顶不住那刺骨的寒风。一脚踏进山峰边的积雪上，快到膝盖了&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-11_10-42-30.jpg&#34; alt=&#34;拉脊山&#34;&gt;&lt;/p&gt;
&lt;p&gt;拉脊山上的洗手间是我们行程中第一个无水洗手的洗手间，当然也不是最后一个&amp;hellip; 我们一行人大概谁也没想到后面的洗手间环境更为恶劣，拿司机的话来说就是辣眼睛 👀 此处省略一万字，请各位看官自行脑补 😁&lt;/p&gt;
&lt;h2 id=&#34;heading-2&#34;&gt;青海湖&lt;/h2&gt;
&lt;p&gt;告别了拉脊山，我们便下山直奔青海湖。从拉脊山前往青海湖大约120公里，我们花了不到两个小时就到了，快到青海湖的时候，我们便远远地看到了一片碧蓝色的大海，犹如镶嵌在高原上的一颗宝石。&lt;/p&gt;
&lt;p&gt;可惜的是5月份还没种油菜花，湖旁边的空地上一片荒凉，只有零星的几根草。这些空地看起来有些有路可以开进去，但需要注意的是，**这些路不是都可以随便进去的，有些是钓鱼执法！牧民会让你按损坏的草的根数进行敲诈勒索！**好在老司机轻车熟路，告诉我们其实青海湖最佳游览点不在官方的二郎剑景区，而在旁边一个私人搭建的区域，这两个的区别在于二郎剑景区有大船，但风大的时候船不会开多远。在司机的建议下，我们去了这个私人区域，司机讨价还价，说淡季便宜点，最终30一个人。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-11_12-47-33.jpg&#34; alt=&#34;青海湖&#34;&gt;&lt;/p&gt;
&lt;p&gt;我们去的那天下午天气还不错，但风那是真的大，湖水很干净，远处颜色很蓝，在尽头相接的雪山就是日月山脉了。雪山脚下充满了西北的特色，全是戈壁滩沙石，寸草不生。&lt;/p&gt;
&lt;p&gt;这个私人景点有几处青海湖的石碑，最适合打卡的是风口浪尖带着牛头的石碑，给个浪花大家感受一下。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-11_13-03-45.jpg&#34; alt=&#34;青海湖&#34;&gt;&lt;/p&gt;
&lt;p&gt;在青海湖逗留了约一个小时，我们便前往号称天空之镜的茶卡盐湖去了，沿途的一些如倒淌河，文成公主等日月山旁的小景点我们觉得没啥意思让司机没停直接开过去了，中饭也是在车内解决节约时间。&lt;/p&gt;
&lt;h2 id=&#34;heading-3&#34;&gt;茶卡盐湖&lt;/h2&gt;
&lt;p&gt;抵达茶卡盐湖的时间大约是下午四点，行程里程约150公里，这段路有不少山路和限速路段，我们行驶了约两个半小时才到。这段路也是典型的西北荒漠，只能看到零星的几根骆驼草散发出的生命的气息，远处偶尔能见一些雪山。&lt;/p&gt;
&lt;p&gt;茶卡盐湖实际上是很大一片盐湖，供工业开采用，我们到达的时候老的景区可能在下雨，于是便尝试了一下路边的广告牌『天空一号』景区，这个景区是新修的，就盐湖构成上和传统的茶卡盐湖景区是一样的。本着猎奇的心态，我们买了门票，电瓶车交通票和下盐湖拍倒影用的靴子。&lt;strong&gt;事实证明这是一次非常失败的尝试&lt;/strong&gt;，当天下午风嗖嗖地刮，再好的湖面也不太可能会有什么天空之镜的效果，游玩体验极差！更为恶劣的是，这个天空一号修这么大，有一大片都是开发中或者未开发的盐湖，没完成的景区就开始收高昂的门票和交通费这一点让我们十分气愤。&lt;/p&gt;
&lt;p&gt;本以为盐湖会像青海湖一样深不见底，实际却发现盐湖普遍不过是浅浅的一层，穿个靴子就能下去了，这样的好处是适合站在湖中拍照，没风的时候适合出大片。如果一定要来茶卡盐湖景区，强烈建议只在风小的时候前往，且在天空一号景区未开发成熟前还是去老的景区，至少老景区还是有些盐雕等适合拍照的打卡地。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-11_16-31-04.jpg&#34; alt=&#34;茶卡盐湖&#34;&gt;&lt;/p&gt;
&lt;p&gt;在茶卡盐湖的这个景点上，根据到达茶卡的时间点，我们是可以选择当天下午或者第二天早晨游玩的，由于我们在之前的景点逗留时间都不长，加之司机开车又快又稳，我们到盐湖的时候还是挺早的。但由于未和司机做充分的沟通，也不了解在天气不好或是风大时不适合游玩盐湖景点，我以为这个景点必须下午玩，于是便让司机去了天空一号景区。在传统的攻略上，会有一项黑马河看日出的行程，但实际上由于黑马河镇太小，太多小作坊式的住宿点，被投诉过于严重，现已被国家强制拆除，所以我们只能夜宿茶卡镇，那些所谓的黑马河看日出也几乎是不可能的了。&lt;/p&gt;
&lt;p&gt;当晚在茶卡镇我们找了家当地的饭店，吃了羊肉火锅，味道也还不错，并且没什么膻味，这一点远超大部分东部城市地区的肥羊。我们住的宾馆就在茶卡盐湖旁边，但由于晚上有点事情，我们也没有出来走走看看日落，接近十点的时候，看了下天空好像也没有什么银河之类的壮观夜景。早上在宾馆外面散步时，发现风还挺小的，其实此时是非常适合去茶卡盐湖打卡拍照的，但因为昨天天空一号被伤过，其他人似乎都无兴致，我也断掉再去老景区打卡的念头了。人多的时候总是众口难调，一起旅游的要么是想法一致，要么能理解其他人并做一定妥协，否则很容易在旅途中产生矛盾。&lt;/p&gt;
&lt;p&gt;羽雀专栏——&lt;a href=&#34;https://www.yuque.com/billryan/siab93&#34;&gt;青甘大环线-西北 6 日行 · 语雀&lt;/a&gt;&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>青甘大环线-行程概览</title>
      <link>https://blog.yuanbin.me/posts/2019-06/2019-06-12_22-00-00/</link>
      <pubDate>Wed, 12 Jun 2019 22:00:00 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-06/2019-06-12_22-00-00/</guid>
      
        <description>&lt;blockquote&gt;
&lt;p&gt;青甘大环线，爬雪山，过草地，穿越无人区。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;自打四月底确定去阿里系的一家公司后，我便和女朋友寻思着怎么利用这段离职交接的间隙来一场家庭旅游。我们的初步候选地点有东南亚、台湾、桂林、云南九寨沟和青海，考虑到签证等多方面因素，我们最终选定了绵延近 3000 公里的甘青大环线。&lt;/p&gt;
&lt;p&gt;看过同学八月份在甘肃和青海的租车自驾攻略，风景真是美如画，便更坚定了自驾游的意愿。借助万能的淘宝，我们找到了一家口碑和价格都极好的旅行社，确定了6天5晚的包车自驾游套餐，最终套餐优惠下来实际上是6天6晚，路线是经典的甘青大环线。&lt;/p&gt;
&lt;h2 id=&#34;heading&#34;&gt;行程概览&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-19_09-45-28.jpg&#34; alt=&#34;行程概览&#34;&gt;&lt;/p&gt;
&lt;p&gt;从上海出发的每天的实际详细行程如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-01_08-07-00.jpg&#34; alt=&#34;上海出发&#34;&gt;&lt;/p&gt;
&lt;p&gt;行程规划类的 APP 之前有用过 出发吧，觉得做的太烂了，这次换成了 穷游行程助手，感觉还凑合。上海到西宁的航班不仅时间不合适，票价还是到兰州的近两倍&amp;hellip; 好在兰州机场有城铁到火车站，所以兰州中转也是可以接受的。&lt;/p&gt;
&lt;p&gt;此次行程主要是包车自驾游，我们的老司机还是挺辛苦的，西宁当地人，对路况非常熟悉，开车技术一流，无人区中能飙150码，在最险的山路上还可以开90 码 😁 司机集多种功能于一身，开车、摄影、介绍沿途典故、景点攻略和美食推荐一样不落！这里要再次感谢马师傅，让我们的西北之行有了更好的安全保障和游玩体验。&lt;/p&gt;
&lt;h2 id=&#34;heading-1&#34;&gt;费用&lt;/h2&gt;
&lt;p&gt;上海到西宁的机票加动车往返全程 1350，包车自驾游1390(含住宿)，吃饭一天在一百以内，门票费用差不多 600，全部费用预估在 4000 以内。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;塔尔寺 70&lt;/li&gt;
&lt;li&gt;拉脊山 0&lt;/li&gt;
&lt;li&gt;青海湖私人景点 30(师傅帮我们砍价了)&lt;/li&gt;
&lt;li&gt;茶卡天空一号 50+20&lt;/li&gt;
&lt;li&gt;翡翠湖 0&lt;/li&gt;
&lt;li&gt;南八仙雅丹魔鬼城 0&lt;/li&gt;
&lt;li&gt;阳关 70&lt;/li&gt;
&lt;li&gt;敦煌石窟 238&lt;/li&gt;
&lt;li&gt;张掖丹霞 70&lt;/li&gt;
&lt;li&gt;嘉峪关那边由于已经逛过阳关了，大家有点累就没去，鸣沙山因为遇到沙尘暴，也取消了&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;heading-2&#34;&gt;交通方案及行前准备&lt;/h2&gt;
&lt;p&gt;由于祖国的大西北普遍地广人稀，路途遥远，所以甘青大环线比较经典的自驾游走法也就那么些，绝大多数人会选择西宁作为行程的起止点，这种走法每天的行程安排较为紧凑。其它城市也不是不可以，难在包车自驾游的选择上。&lt;/p&gt;
&lt;h3 id=&#34;heading-3&#34;&gt;西宁不便则从兰州或张掖中转&lt;/h3&gt;
&lt;p&gt;由于西宁不是热门的西北城市，交通还是略显不便的，上海这边直达的航班不仅比较少，而且还比较贵，单程都要1000多了。看了看淘宝上套餐中兰州起止的方案，其实也是先到兰州再自行去西宁的，所以甘青环线不管怎么安排，比较好的选择中，基本都绕不开以西宁作为起止点。&lt;/p&gt;
&lt;p&gt;在西北的这些城市中，西宁旁边的城市有兰州和张掖，兰州机场到兰州火车站，有专门的城铁(35分钟到兰州西站)，机场内即可无缝接驳，兰州火车西站到西宁则有动车和直达车(2小时多一点)，两趟火车的价格加起来几十块就搞定了。所以如果选择兰州作为中转，机票往返才1210，比直接到西宁的方案便宜接近一半，而且可以虹桥起飞，代价则是会多两小时的火车中转时间。&lt;/p&gt;
&lt;p&gt;张掖到西宁的动车时间一般在两小时以内，和兰州的时间相差不大。但直飞张掖的航班就比兰州少多了，上海过去有一趟春秋的航班，价格比较便宜。关于动车和普通直达车的选择: 建议多花一二十块享受下更为舒适的动车，还可以选座。七月八月是西北的旅游旺季，刚查了下直飞西宁的价格和兰州也相差不远了，所以还是建议兰州，张掖和西宁这三种航班方案都比较下。&lt;/p&gt;
&lt;h3 id=&#34;heading-4&#34;&gt;上海出发行程参考&lt;/h3&gt;
&lt;p&gt;附上我们当时上海出发的行程参考&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;去程：上海 -&amp;gt; 兰州 -&amp;gt; 西宁&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-06-02_08-08-13.jpg&#34; alt=&#34;上海出发&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;回程：西宁 -&amp;gt; 兰州 -&amp;gt; 上海&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-06-02_08-08-20.jpg&#34; alt=&#34;回上海&#34;&gt;&lt;/p&gt;
&lt;p&gt;回程怕赶不上飞机也可以前一天晚上住兰州火车站，不担心的大可西宁休息第二天赶车。&lt;/p&gt;
&lt;h2 id=&#34;heading-5&#34;&gt;行前准备&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;温度：青甘大环线上一路都是高原为主，也有几处为雪山，所以防寒肯定跑不掉的。&lt;/li&gt;
&lt;li&gt;大风及沙尘：运气不好的话会遇到大风和沙尘天气，迪卡侬有专业的防风沙面罩，强烈建议入手。&lt;/li&gt;
&lt;li&gt;医药：特殊的药品一定要自带，一路上以小镇为主，药店少的可怜，只有一些常用药。担心落地就高原反应的可以带一些高反药物。一般如果是包车自驾游的旅行社产品车上会带。&lt;/li&gt;
&lt;li&gt;手机信号：大部分地方信号还是可以的，一少部分无人区公路和山路信号不太好，移动的信号覆盖度普遍会好一点点。&lt;/li&gt;
&lt;li&gt;景点门票：敦煌莫高窟一定要提前一个月甚至更早预约，莫高窟这个门票需要到他的指定网站购买，无法在其他 APP 购买。部分景点对电子票有生效期的限制，建议提前至少一个小时购买，否则到了景区可能无法兑换。&lt;/li&gt;
&lt;li&gt;区间限速：可以开一段超速的搭配中途休息拍照缓冲。&lt;/li&gt;
&lt;li&gt;自驾：如果不请当地司机的话一定要提前熟悉下路况，部分山路还是挺危险的。&lt;/li&gt;
&lt;li&gt;饮食：当地以清真为主，建议尊重一些当地的风俗，不带酒及外食。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在行程的前几天，旅行社便安排司机师傅对接了，并约定抵达西宁的当天由师傅接送至宾馆，我们住在西宁的第一晚是吉华宾馆，条件还不错。5月10日从兰州坐火车抵达西宁车站大约是五点半，我们出站后发现司机师傅已早早地在车站旁边等候了，感觉很守时，赞一个。看得出来师傅是位很客气友好的老司机，一问是当地人，给我们介绍了哪里有好吃的，哪里可以买到本地的特产而且不容易被宰。宾馆离火车站很近，几分钟后便到了，到宾馆办理完入住手续后司机便载我们到当地的新千国际广场大快朵颐。&lt;/p&gt;
&lt;h2 id=&#34;heading-6&#34;&gt;吃吃吃&lt;/h2&gt;
&lt;p&gt;晚上我们吃了当地有名的炕锅羊肉，一大盘只要138，肉比较足，味道也鲜美，问了下老板有没有汤和米饭之类的，答曰没有。店家给的说法是他们这里的市场规则是这家店不允许提供汤和米饭，需要的要去旁边其它专门卖米饭或者卖汤的店买。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.yuanbin.me/pictures/2019/201905/2019-05-10_18.47.39.jpg&#34; alt=&#34;大餐&#34;&gt;&lt;/p&gt;
&lt;p&gt;酒足饭饱后我们步行回到了宾馆，在回宾馆的路上遇到了清真寺开斋或是礼毕，门口的小孩子端着一盆又一盆葡萄干和大枣，嗯，很香！&lt;/p&gt;
&lt;h2 id=&#34;heading-7&#34;&gt;早起防坑&lt;/h2&gt;
&lt;p&gt;对于明天第一站塔尔寺的行程，司机特意说了塔尔寺需要赶在七点半工作人员到达，否则需要停至他们指定的停车场，并额外交几十块的电瓶车费用用于抵达景区门口。去西北的景点玩的多了后发现，这些都是西北旅游景点的套路，检票口修在离真实景点很远的地方，让你几乎一定会乘坐他们的内部交通工具，最常见的就是这种能装不少人的电瓶车了，这种车一趟一般都是20起步，简直是暴利！&lt;/p&gt;
&lt;h2 id=&#34;heading-8&#34;&gt;旅游方案选择&lt;/h2&gt;
&lt;p&gt;青海甘肃这一圈有大环线和小环线两种方案，时间长的到一周可以建议大环线，时间紧张只有四天的建议小环线，小环线的景观密度更高，但是会少了敦煌这一文化瑰宝。自驾游的话，选好司机非常重要，安全第一，不要一味图便宜！&lt;/p&gt;
&lt;p&gt;值得一提的是敦煌石窟门票需要提前网上预约，遇到下雨等不良天气时可能无法参观。西北这边的大环线想要玩的好，选对季节和天气很重要，我们五月中旬去了一趟感觉还是不理想，前三天天气虽好，但是狂风大作，茶卡盐湖也不再是『天空之镜』，后三天偶遇沙尘暴，尘土飞扬，山上的草也还是略显枯黄，少了几分生命的脉动。七八月是最佳旅游时节，但这两个月各种费用都贵，暑假学生也多，做好心理准备 😁&lt;/p&gt;
&lt;p&gt;通过此次西北之行，我们感受到了西北真是地广人稀，水资源的宝贵。如果再去一次大西北，我会选择七八月再去看看那广袤的门源油菜花海和祁连山下的大草原，秋天再去邂逅那最美的227国道。&lt;/p&gt;
&lt;p&gt;后文将分景点单独介绍我们的旅游体验，敬请关注 😄&lt;/p&gt;
&lt;p&gt;羽雀专栏——&lt;a href=&#34;https://www.yuque.com/billryan/siab93&#34;&gt;青甘大环线-西北 6 日行 · 语雀&lt;/a&gt;&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>青甘大环线 6 日游</title>
      <link>https://blog.yuanbin.me/posts/2019-06/2019-06-02_23-16-23/</link>
      <pubDate>Sun, 02 Jun 2019 23:16:23 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-06/2019-06-02_23-16-23/</guid>
      
        <description>&lt;p&gt;5 月 10 日从上海出发，至 17 号抵达上海，大环线车程耗时 6 天，全程近 3000 公里，终于有机会一睹西北的风采了。前三天的天气还凑合，可从第四天开始就遇到了沙尘暴，所有景点几乎全蒙上了一层阴影，好些景点因为天气和人的原因都没去成。以后争取七月八月再去一次小环线吧，真是心有不甘。游记的图片还是略多的，博客里面插图还是略显不便，周末试用了一下蚂蚁的 &lt;a href=&#34;https://www.yuque.com&#34;&gt;羽雀&lt;/a&gt;, 第一次知道这货是因为团队内部在内网用羽雀协作文档。偶然发现外网也有，用来写游记还真不错，欢迎有兴趣的前往我的 &lt;a href=&#34;https://www.yuque.com/billryan/siab93&#34;&gt;青甘大环线&lt;/a&gt; 专栏阅读。&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>阿里云 EMR gateway 替代方案</title>
      <link>https://blog.yuanbin.me/posts/2019-03/2019-03-25_20-59-21/</link>
      <pubDate>Mon, 25 Mar 2019 20:59:21 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-03/2019-03-25_20-59-21/</guid>
      
        <description>&lt;p&gt;本文主要分享小规模开发测试环境下阿里云 EMR gateway 节点的替代方案，同时也为想寻找同时支持 HTTP proxy 和 websocket 的代理工具提供一些思路。传统的 HTTP proxy 有 Squid, 但是 Squid 对 HTTPS, HTTP/2 和 websocket 的支持不算太好。在大部分简单场景下，我推荐部署和配置极其简单的 &lt;a href=&#34;https://caddyserver.com/&#34;&gt;Caddy&lt;/a&gt;, 配合 forwardproxy 插件配置起来非常简单。&lt;/p&gt;
&lt;p&gt;到官网下载即可，选中 &lt;code&gt;http.forwardproxy&lt;/code&gt;，可能需要根据自己的平台适配，如 Linux64 下可以如下安装。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl https://getcaddy.com | bash -s personal http.forwardproxy
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;想作为系统启动服务进行管理可参考 Caddy 的 systemd 服务，见 &lt;a href=&#34;https://raw.githubusercontent.com/mholt/caddy/master/dist/init/linux-systemd/caddy.service&#34;&gt;caddy.service&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0.0.0.0:3128 {
    errors
    forwardproxy {
        basicauth your_user your_pass
        acl {
            allow 10.0.x.0/24
            deny all
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中的 ACL 规则和认证可根据自己集群的情况进行调整。配合 letsencrypt, Caddy 还可以支持 HTTP/2(HTTPS) 代理，很美好&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>信息流推荐和搜索的实时数据流架构</title>
      <link>https://blog.yuanbin.me/posts/2019-03/2019-03-19_23-33-51/</link>
      <pubDate>Tue, 19 Mar 2019 23:33:51 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-03/2019-03-19_23-33-51/</guid>
      
        <description>&lt;p&gt;本文主要介绍了自己近两个月重构产品推荐引擎后端的实时数据流同步架构，抛弃了之前的 Spark Streaming, 选择了基于 Kafka Stream 以及 Kafka Connect 做一些轻量级的实时 ETL.&lt;/p&gt;
&lt;h2 id=&#34;heading&#34;&gt;数据流同步架构&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;                +-------+         +---------------+
                | Redis +&amp;lt;-+   +-&amp;gt;+ Elasticsearch |
                +-------+  |   |  +---------------+
                           |   |
                           |   |
                           |   |
    +--------------+  +----+---+------+
+---+ Kafka Stream |  | Kafka Connect |
|   +------+-------+  +-------+-------+
|          ^                  ^
|          |                  |
|          |                  |
|    +-----+------------------+------+
+---&amp;gt;+             Kafka             |
     +---+--------------------+------+
         ^                    ^
         |Maxwell             |
         |                    |
     +---+----+       +-------+------+
     | binlog |       | tracking log |
     +----+---+       +--------------+
          ^
          |
          |
      +---+---+
      | MySQL |
      +-------+
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;binlog--kafka-maxwell-vs-canal&#34;&gt;binlog 到 Kafka 工具选型，maxwell vs canal&lt;/h3&gt;
&lt;p&gt;从数据的生产者来看，我们的数据源主要由产品数据库 MySQL(binlog) 和前端用户行为日志埋点两部分构成。binlog 到 Kafka 我选用了 &lt;a href=&#34;https://github.com/zendesk/maxwell&#34;&gt;zendesk/maxwell&lt;/a&gt; 而不是国内使用较多的 &lt;a href=&#34;https://github.com/alibaba/canal&#34;&gt;alibaba/canal&lt;/a&gt;. 原因主要是因为我们的产品库目前还比较单一，maxwell 使用和部署比较简单，而且能以已经解析好的 schema 数据进入 Kafka, 这对后面对接的 Elasticsearch 非常友好。新版的 canal 其实也具备了直接生产到 Kafka 和 Elasticsearch 的能力了，但就到 Kafka 这一环来说，canal 在使用上还是有一些不便利的地方，maxwell 在一些细节上更为便利些。但是需要注意的是，maxwell 在生产环境上需要自己定制 HA 方案，就我们的实测发现，产品起步阶段的量级用 maxwell 毫无压力。&lt;/p&gt;
&lt;h3 id=&#34;kafka-stream--etl-&#34;&gt;Kafka Stream, 实时 ETL 的好工具&lt;/h3&gt;
&lt;p&gt;国内 Kafka Stream 的文档相对还是不多的，Kafka 官网和 confluent 的文档比较详细，可以读一读。在尝试 Kafka Stream 之前，因为自己对 Spark 熟悉一些，尝试了 Spark Streaming 作为实时数据同步任务。使用过程中我们发现一些痛点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Spark 开发起来太重了，对小团队有较高的使用成本&lt;/li&gt;
&lt;li&gt;CICD 融入 K8S 比较困难，开发迭代较慢&lt;/li&gt;
&lt;li&gt;资源消耗高，不适合小公司/初创公司&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;在读了一些 Kafka Stream 的文档后，我首先写了一个 &lt;code&gt;kafka-stream-filter&lt;/code&gt; 作为 binlog 到 Kafka 的路由分发器。觉得确实和文档里说的一样，非常轻，使用 Kafka Stream 只需要像其它普通库一样使用，但是可以完美结合 Kafka 的水平 scale 能力，没有水平扩展的压力。部署上，我可以像普通 Java 应用一样部署在 K8S 上，运维管理上比较统一。资源上也能节约不少，测试环境上数据量小一点的内存分配 500MB 以内足够了。&lt;/p&gt;
&lt;p&gt;Kafka Stream 的定位并不是一个 ETL 的全能工具，它聚焦在以 Kafka 为核心的 ETL, 数据输出也通常在 Kafka 的其它 topic 中。&lt;/p&gt;
&lt;h3 id=&#34;kafka-connect--kafka-&#34;&gt;Kafka Connect, 沟通 Kafka 和其它存储系统的桥梁&lt;/h3&gt;
&lt;p&gt;如果说 Kafka Stream 可以专注于实时 ETL 并将数据存储在 Kafka 中，那么 Kafka Connect 解决的问题则是如何将 Kafka 和外部存储系统对接了。官方的 Kafka Connect 已经为我们准备好了很贴心的同步框架，容错、任务数扩展等都比较完善。即使自己从头开发，开发成本也不算高。后文我会开源自己设计的 &lt;code&gt;kafka-connect-redis&lt;/code&gt; 和 &lt;code&gt;kafka-connect-elasticsearch&lt;/code&gt;. 同步协议上参考了 maxwell, 有点类似 Event Sourcing.&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>JVM 在 Docker 等容器环境下的资源限制问题</title>
      <link>https://blog.yuanbin.me/posts/2019-03/2019-03-18_23-30-06/</link>
      <pubDate>Mon, 18 Mar 2019 23:30:06 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-03/2019-03-18_23-30-06/</guid>
      
        <description>&lt;h1 id=&#34;heading&#34;&gt;堆内存设置&lt;/h1&gt;
&lt;p&gt;Java 程序中，我们通常比较关注堆的使用情况，一般通过 &lt;code&gt;-Xmx&lt;/code&gt; 和 &lt;code&gt;-Xms&lt;/code&gt; 分别控制最大和最小可用堆内存大小。在容器环境中，如果不显式指定堆内存参数，老的 JVM 版本是无法感知容器的资源限制的。在新的 JDK 8u191 版本以后，我们已经可以享受到新版 JVM 对容器的良好支持，并且可以通过 &lt;code&gt;-XX:InitialRAMPercentage&lt;/code&gt; 和 &lt;code&gt;-XX:MaxRAMPercentage&lt;/code&gt; 控制堆内存启动时和最大可用内存百分比。考虑到堆外内存的使用，&lt;code&gt;-XX:MaxRAMPercentage&lt;/code&gt; 不宜设置过高，具体值可以根据自己应用的情况灵活设置。需要注意的是百分比需要包含一位小数，否则会报错。文末有 Dockerfile 可供参考。&lt;/p&gt;
&lt;h1 id=&#34;jmap--jvm-&#34;&gt;jmap 等 JVM 诊断工具无法正常使用&lt;/h1&gt;
&lt;p&gt;由于容器的特殊性，应用启动时的进程 ID 其实是 1, jmap/jstat/jstack 等诊断工具依赖底层的 &lt;code&gt;PTRACE_ATTACH&lt;/code&gt;, 而由于 docker 后期版本的安全加固原因，这种操作是不允许的。因此我们可以想办法让 JVM 应用不以 PID 1 运行即可，但又能正常接收来自容器的停止等信号，这就是 &lt;a href=&#34;https://github.com/krallin/tini&#34;&gt;krallin/tini&lt;/a&gt; 的用武之地了！&lt;/p&gt;
&lt;h1 id=&#34;cpu-&#34;&gt;CPU 核数&lt;/h1&gt;
&lt;p&gt;TODO&lt;/p&gt;
&lt;h1 id=&#34;dockerfile&#34;&gt;Dockerfile&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/billryan/devops/blob/master/docker/jdk/Dockerfile&#34;&gt;devops/Dockerfile&lt;/a&gt; 是我自用的 JDK 的基础镜像(基于 Alpine, JDK 8u191) 包含阿里的 &lt;a href=&#34;https://alibaba.github.io/arthas/&#34;&gt;Arthas&lt;/a&gt; 诊断利器，已设置时区为东八区。&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>神策 Kafka 0.8.2 Mirror Maker 优化</title>
      <link>https://blog.yuanbin.me/posts/2019-03/2019-03-14_09-47-39/</link>
      <pubDate>Thu, 14 Mar 2019 09:47:40 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2019-03/2019-03-14_09-47-39/</guid>
      
        <description>&lt;p&gt;由于历史原因，我们采购的神策所用的 Kafka 是老版本 0.8.2, 其所有的项目均在同一 topic 中，所以在构建我们的实时数据管道的过程中，我们需要对原有神策 Kafka 做如下两点改造：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;将属于我们的项目的数据单独过滤出来，通过原始的 &lt;code&gt;kafka-mirror-maker&lt;/code&gt; 只能做到 topic 级别的复制&lt;/li&gt;
&lt;li&gt;镜像到我们自建的 Kafka 数据管道时，尽可能保证事件有序，尤其是对同一用户的行为事件&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;第一个问题，在新版 Kafka, 如 1.0 之后的版本中，我们可以实现 &lt;code&gt;kafka-mirror-maker&lt;/code&gt; 的接口进行加载定制，无需对原有 Kafka 源码进行变动。但是在 0.8.2 这个老版本还是做不到，故需要对源码中有关 &lt;code&gt;kafka-mirror-maker&lt;/code&gt; 进行改造。第二个问题，Kafka 只能保证分区内有序，无法做到全局有序的，但是我们如果能将神策行为事件中的用户 ID 提取作为 key, 属于同一用户的行为事件自然就在同一 partition 中了。&lt;/p&gt;
&lt;p&gt;改动过的源码见 &lt;a href=&#34;https://github.com/billryan/kafka-mirror-maker/commit/85b2dabc7fa2050aaaf1afea64a1e64ccd79be8e&#34;&gt;MirrorMaker&lt;/a&gt;, 相关的 Makefile 及 Dockerfile 也一并提供了。&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>为 Hugo even 主题移植 comment.js 评论插件</title>
      <link>https://blog.yuanbin.me/posts/2018-08/2018-08-19_16-59-31/</link>
      <pubDate>Sun, 19 Aug 2018 16:59:31 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2018-08/2018-08-19_16-59-31/</guid>
      
        <description>&lt;p&gt;在前文 &lt;a href=&#34;http://blog.yuanbin.me/posts/2018-02/2018-02-23_23-19-29/&#34;&gt;博客写作工作流&lt;/a&gt; 中我提到过一些关于博客评论系统的选择，简单来说就是弃用了 disqus, 选择了基于 GitHub issue 的评论方案，而由于 GitHub 之前 OAuth 鉴权粒度不够细，基于 gitalk/gitcoment 的方案会导致在博客当前页面评论登陆 GitHub 时提示的权限有点多，比如读写权限。新的基于 GitHub App 的方案如 &lt;a href=&#34;https://github.com/utterance/utterances/pull/25&#34;&gt;utterances 1.0&lt;/a&gt; 就会好很多了。但这种方式对于非知名公司/个人博主来讲，我是不敢随便去让这种 app 接入的。基于同样的理念，我找到了 wzpan 的 &lt;a href=&#34;https://github.com/wzpan/comment.js&#34;&gt;wzpan/comment.js&lt;/a&gt; &lt;a href=&#34;http://www.hahack.com/codes/comment-js/&#34;&gt;中文文档&lt;/a&gt;, 这种方案将鉴权完全转移至 GitHub 上控制，安全感会好很多。稍显麻烦的是会有一个跳转而不是直接在本页评论。下面我详细介绍一下 Hugo even 下的如何使用 comment.js&lt;/p&gt;
&lt;p&gt;由于目前还未向 even 发起 PR, 所以现在想使用的话可以直接使用我 fork 改过的 ==&amp;gt; &lt;a href=&#34;https://github.com/billryan/hugo-theme-even&#34;&gt;billryan/hugo-theme-even&lt;/a&gt;, 具体配置同 comment.js 要求，你可以参考我的 &lt;a href=&#34;https://github.com/billryan/blog/blob/master/config.toml&#34;&gt;blog/config.toml&lt;/a&gt;, 主要是一些如 owner, repo, token 的设置。对 comment.js 有需求的可以留言，我可以尝试向 even 发起一个 PR 合并到官方去。&lt;/p&gt;
&lt;p&gt;核心配置如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  [params.comment]           # comment is a comment system based on GitHub issues. see https://github.com/gitalk/gitalk
    owner = &amp;quot;billryan&amp;quot;              # Your GitHub ID
    repo = &amp;quot;blog&amp;quot;               # The repo to store comments
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;看完 comment.js 的文档后移植起来其实是非常简单的，在这个过程中我还参考了 &lt;a href=&#34;https://github.com/olOwOlo/hugo-theme-even/pull/51&#34;&gt;feat: add gitalk&lt;/a&gt;, 加入了一些公开的 CDN 资源，在 comment.js 的基础上增加了 &lt;code&gt;.btn&lt;/code&gt; 的样式，这个样式参考了 GitHub issue. 另外我默认开启了 highlight 和 spin 这两个特性。&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>基于大数据平台的客户像系统设计</title>
      <link>https://blog.yuanbin.me/posts/2018-08/2018-08-02_23-59-46/</link>
      <pubDate>Thu, 02 Aug 2018 23:59:46 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2018-08/2018-08-02_23-59-46/</guid>
      
        <description>&lt;p&gt;客户画像系统在不同公司有不同的业务场景需求，但总的目标基本都是由于客户越来越多，我们需要对海量的客户信息进行降维，进而更好的理解客户和精准推荐或者营销。基础的客户画像系统有如下几种需求：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;输入用户 id, 输出用户相应的画像标签&lt;/li&gt;
&lt;li&gt;输入用户 id，相应标签和指定时间区间，输出对应标签值在这段时间内的变化情况&lt;/li&gt;
&lt;li&gt;输入多个标签值，输出满足指定标签值的一组用户(精准推荐或营销用)&lt;/li&gt;
&lt;li&gt;输出的标签最好能和业务数据进行关联&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这四个需求虽然都可以通过 HBase 实现，但是对于需求3这种搜索的场景，用 HBase 来实现则往往需要 scan 全表，而且范围查询也不易实现。我们可以选用 ES(ElasticSearch) 来作为搜索过滤。对于需求4，常用的数据仓库有 Hive, 我们可以通过外表的形式关联 HBase, 也可以定期从 HBase 导入至 Hive.&lt;/p&gt;
&lt;h2 id=&#34;heading&#34;&gt;系统架构及数据流&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;源数据层：数据源可以是关系型数据库，实时行为日志，Hive 仓库或者从 HBase 加工过的标签数据。&lt;/li&gt;
&lt;li&gt;计算引擎层：使用 Spark 作为中间的计算引擎和不同的数据源接口可以省掉繁琐的数据驱动整合工作，同时借助 dataframe API 可以高效的进行异构数据源关联分析和处理。&lt;/li&gt;
&lt;li&gt;数据分发层：使用 HBase 作为主存储，ES 通过 HBase 的 coprocessor 机制同步更新，往 ES 写可以通过批量写减少网络 IO。Hive 通过外表则不必做专门的数据同步操作，但是这种方法效率往往不高。&lt;/li&gt;
&lt;li&gt;数据对外使用层：通过 REST API 查询 HBase 和 ES 获取所需标签/用户 id&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;                                                  +------------+
                                                  |            |
                              +-----------------&amp;gt; |  REST API  |
                              |                   |            |
                              |                   +------+-----+
                              |                          ^
                              |                          |
                              |                          |
+--------+               +----+----+                +----+----+
|        |    external   |         |  coprocessor   |         |
|  Hive  | &amp;lt;-------------+  HBase  +--------------&amp;gt; |    ES   |
|        |               |         |                |         |
+--------+               +----+----+                +---------+
                              ^
                              |
                +-------------+-------------+
                |                           |
                |  Spark / Spark Streaming  |
                |                           |
                +-------------+-------------+
                              ^
                              |
         +--------------------+------------------+
         |                                       |
         |  Hive, SQLServer, MySQL, HBase, HDFS  |
         |                                       |
         +---------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Spark 写 HBase 可以用 &lt;a href=&#34;https://github.com/hortonworks-spark/shc&#34;&gt;hortonworks-spark/shc&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其中 HBase 写 ES 和 Hive 建外表的细节另外写两篇博文做深度一点的解析，这里不再赘述。&lt;/p&gt;
&lt;h2 id=&#34;heading-1&#34;&gt;数据模型映射&lt;/h2&gt;
&lt;h3 id=&#34;spark-dataframe--hbase&#34;&gt;Spark dataframe &amp;lt;==&amp;gt; HBase&lt;/h3&gt;
&lt;p&gt;我们知道 HBase 主要是通过 rowkey 来实现快速查询，对于典型的用户画像场景，用户 id 往往必不可少。但 rowkey 在 HBase 中的存储为字节数组，且为了更好发挥 HBase 分布式存储的效率，我们需要防止用户 id 过于集中造成热点，这里我们可以尝试将 int 型数据映射到 00000000~FFFFFFFF 内，然后反转字符串即可完美适配 HBase 对 rowkey 设计的要求。&lt;/p&gt;
&lt;p&gt;对于 HBase 往 ES 的数据同步，我们主要利用了 HBase coprocessor 绑定更新/删除事件进而对 ES 同步。这里一个比较棘手的问题是 HBase 的内容都是以字节数组存储的，比较理想的方案是同步到 ES 时保留类型信息以便范围查询。这里我采取的方案是通过 Spark dataframe 取出类型信息，在写入 HBase 时列的最后一个字节用于类型标记，如 &lt;code&gt;i -&amp;gt; integer&lt;/code&gt;, &lt;code&gt;d -&amp;gt; double&lt;/code&gt;, &lt;code&gt;s -&amp;gt; string&lt;/code&gt;. 这样就完美的解决了类型的转化问题了，还能自适应匹配。&lt;/p&gt;
&lt;p&gt;HBase 中的 rowkey 可以映射为 ES 中的 docid, 列名 &lt;code&gt;cf:tag_namespace.tag_name&lt;/code&gt; 可以映射为 ES 中的 JSON 嵌套结构。&lt;/p&gt;
&lt;h3 id=&#34;hbase--elasticsearch&#34;&gt;HBase &amp;lt;==&amp;gt; ElasticSearch&lt;/h3&gt;
&lt;p&gt;TODO&lt;/p&gt;
&lt;h3 id=&#34;hbase--hive&#34;&gt;HBase &amp;lt;==&amp;gt; Hive&lt;/h3&gt;
&lt;p&gt;TODO&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>HAProxy 进阶使用技巧</title>
      <link>https://blog.yuanbin.me/posts/2018-06/2018-06-30_21-26-14/</link>
      <pubDate>Sat, 30 Jun 2018 21:26:14 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2018-06/2018-06-30_21-26-14/</guid>
      
        <description>&lt;p&gt;本文主要记录了一些在特殊网络下使用 HAProxy 的一些进阶使用技巧，如网络上层应用 Health Check 的精准检测(HA)和负载均衡。本期主要介绍 Health Check 在 proxy 中的使用细节。&lt;/p&gt;
&lt;h2 id=&#34;health-check&#34;&gt;Health Check&lt;/h2&gt;
&lt;p&gt;我们使用 HAProxy 作为大局域网内的多 VPS 聚合和 HA 是想尽可能提高科学服务的稳定性的，进程异常退出和 TCP 端口连接超时这些问题都是比较容易检测出来的，但是还有一些时候通往国外的 TCP 端口连接正常，可科学服务就是有问题。这种场景下，我们就需要利用 HAProxy 高级一点的 TCP 或者 HTTP 检活机制了，让其更接近上层应用的真实需求。&lt;/p&gt;
&lt;p&gt;在了解 HAProxy Health Check 的进阶技巧之前，推荐去看看 &lt;a href=&#34;http://cbonte.github.io/haproxy-dconv/&#34;&gt;HAProxy 官网文档&lt;/a&gt; 和 &lt;a href=&#34;https://www.haproxy.com/documentation/aloha/7-0/traffic-management/lb-layer7/health-checks/&#34;&gt;Performing Health Checks&lt;/a&gt; 官网文档有利于了解 HAProxy 的全貌，而后文则对你了解 HAProxy 的 Health Check 机制更有帮助。对于我们的科学网络服务，更贴近上层应用的检活机制恐怕非 Google 的 &lt;code&gt;generate_204&lt;/code&gt; 服务莫属了，我们只需要请求 &lt;a href=&#34;http://client3.google.com/generate_204&#34;&gt;http://client3.google.com/generate_204&lt;/a&gt; 即可判断网络是否连通。由于是一个 HTTP 请求，我们可以利用 HAProxy 的 &lt;code&gt;tcp-check&lt;/code&gt; 和 &lt;code&gt;http-check&lt;/code&gt; 分别检测 &lt;code&gt;socks5&lt;/code&gt; 和 &lt;code&gt;http&lt;/code&gt; proxy.&lt;/p&gt;
&lt;h3 id=&#34;tcp-check&#34;&gt;tcp-check&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;tcp-check&lt;/code&gt; 机制相对麻烦一些，毕竟是处于应用层之下的协议，&lt;code&gt;tcp-check&lt;/code&gt; 中，我们需要发送的内容是 TCP payload, 这部分可以通过 tcpdump 或者更为直观一点的 wireshark 抓包得到。以 &lt;code&gt;socks5&lt;/code&gt; 为例，HAProxy 中的配置如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;listen ha-socks5
    bind 127.0.0.1:xxxx
    option tcp-check
    tcp-check connect
    tcp-check send-binary 05020001
    tcp-check expect binary 0500
    tcp-check send-binary 0501000312636c69656e74332e676f6f676c652e636f6d0050
    tcp-check expect binary 050000010000000006b5
    #tcp-check send-binary 474554202f67656e65726174655f32303420485454502f312e310d0a486f73743a20636c69656e74332e676f6f676c652e636f6d0d0a557365722d4167656e743a206375726c2f372e35342e300d0a4163636570743a202a2f2a0d0a0d0a
    tcp-check send GET\ /generate_204\ HTTP/1.1\r\n
    tcp-check send Host:\ client3.google.com\r\n
    tcp-check send User-Agent:\ curl/7.54.0\r\n
    tcp-check send Accept:\ */*\r\n
    tcp-check send \r\n
    tcp-check expect rstring ^HTTP/1.1\ 204
    balance     source
    hash-type consistent # optional
    server xxx1 127.0.0.1:11110 check
    server xxx2 127.0.0.1:11111 check backup
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;从以上配置可以看出我们利用 HAProxy 模拟了 &lt;code&gt;socks5&lt;/code&gt; 请求的全过程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;建 TCP 连接&lt;/li&gt;
&lt;li&gt;协商认证方式&lt;/li&gt;
&lt;li&gt;协商访问目标主机&lt;/li&gt;
&lt;li&gt;发送真正代理请求&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其中第2步和第3步与 socks server 的实现有关系，需要自己抓包进行分析，着重分析 TCP payload(data) 部分就好了。多行 send 请求会合并为一行，当然你也可以选择发送对应的二进制内容。&lt;/p&gt;
&lt;p&gt;socks5 协议细节可参考 &lt;a href=&#34;https://www.ietf.org/rfc/rfc1928.txt&#34;&gt;https://www.ietf.org/rfc/rfc1928.txt&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;http-check&#34;&gt;http-check&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;http-check&lt;/code&gt; 的配置相对简单一些，HAProxy 的配置如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;listen ha-http
    bind :::xxxx
    option httpchk GET http://client3.google.com/generate_204 HTTP/1.1\r\nHost:\ client3.google.com\r\nProxy-Authorization:\ Basic\ xxxx\r\nProxy-Connection:\ Keep-Alive
    balance     source
    hash-type consistent # optional
    server xxx1 127.0.0.1:11120 check
    server xxx2 127.0.0.1:11121 check backup
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;需要注意的是其中 &lt;code&gt;\r\n&lt;/code&gt; 和 &lt;code&gt;\ &lt;/code&gt; 空格的发送，由于我的 http proxy 配置了 Basic 认证，因此在这里也需要一并加上，Basic 的内容是对用户名和密码 base64 编码，这个报文细节可以通过 curl -v 得到。&lt;/p&gt;
&lt;h2 id=&#34;load-balance&#34;&gt;Load Balance&lt;/h2&gt;
&lt;p&gt;细心的小伙伴可能会发现上述 Health Check 的配置中 balance 使用了 source.&lt;/p&gt;
&lt;p&gt;待续&amp;hellip;&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>Hue hive metastore 显示时间差的问题</title>
      <link>https://blog.yuanbin.me/posts/2018-04/2018-04-20_17-24-14/</link>
      <pubDate>Fri, 20 Apr 2018 17:24:14 +0800</pubDate>
      
      <guid>https://blog.yuanbin.me/posts/2018-04/2018-04-20_17-24-14/</guid>
      
        <description>&lt;p&gt;Hue 中通过 Hive metastore 查看表创建信息时，我们发现其中 Overview 和 Details 的时间差总是6个小时，按理北京时间东八区相差8个小时才合理啊，接下来我们跟一下 Hue 中的代码。&lt;/p&gt;
&lt;p&gt;从 Overview 中分析 Properties 中的时间 Created 的源码可以发现其使用的是&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;data-bind=&amp;quot;text: localeFormat(details.properties.create_time)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;从 &lt;code&gt;localeFormat&lt;/code&gt; 的函数继续跟踪可以发现使用的其实是 moment 库中的 utc 方法，&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;return moment.utc(mTime).format(&amp;quot;L LT&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;从以上两段代码来看，Overview 中 Created 的显示时间比 Details 中的北京时间晚8小时才对，但实际却比北京时间提前了6小时!&lt;/p&gt;
&lt;p&gt;百思不得其解，后面才发现，这是 JavaScript 对时区处理的坑！！！&lt;/p&gt;
&lt;p&gt;Details 中 CreateTime 为 &lt;code&gt;Wed Apr 04 15:41:58 CST 2018&lt;/code&gt;, 其中的 CST 可以是『Central Standard Time 美国中部时间』和『中国标准时间』，而美国中部时间是西六区&amp;hellip; JS 将 CST 作为美国中部时间处理了&amp;hellip;&lt;/p&gt;
</description>
      
    </item>
    
  </channel>
</rss>
